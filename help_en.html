<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Help - MeteoRide</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            line-height: 1.6;
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
            background: #f0f4f8;
            color: #243746;
        }
        .header {
            background: #1e40af;
            color: white;
            padding: 1rem;
            border-radius: 10px;
            margin-bottom: 2rem;
            text-align: center;
            position: relative;
        }
        .back-button {
            position: absolute;
            left: 1rem;
            top: 50%;
            transform: translateY(-50%);
            background: rgba(255,255,255,0.2);
            color: white;
            border: 1px solid rgba(255,255,255,0.3);
            padding: 0.5rem 1rem;
            border-radius: 6px;
            text-decoration: none;
            font-size: 0.9rem;
            transition: all 200ms ease;
        }
        .back-button:hover {
            background: rgba(255,255,255,0.3);
            text-decoration: none;
            color: white;
        }
        .section {
            background: white;
            padding: 1.5rem;
            margin-bottom: 1.5rem;
            border-radius: 10px;
            box-shadow: 0 2px 8px rgba(30, 64, 175, 0.1);
        }
        h1 { margin: 0; }
        h2 { color: #1e40af; border-bottom: 2px solid #e0ebff; padding-bottom: 0.5rem; }
        h3 { color: #2563eb; margin-top: 1.5rem; }
        .step { 
            background: #f8fafc; 
            padding: 1rem; 
            margin: 1rem 0; 
            border-left: 4px solid #2563eb; 
            border-radius: 0 8px 8px 0;
        }
        .tip {
            background: #fff7ed;
            border: 1px solid #fdba74;
            padding: 1rem;
            border-radius: 8px;
            margin: 1rem 0;
        }
        .warning {
            background: #fee2e2;
            border: 1px solid #fca5a5;
            padding: 1rem;
            border-radius: 8px;
            margin: 1rem 0;
        }
        .privacy {
            background: #f0f9ff;
            border: 1px solid #0ea5e9;
            padding: 1rem;
            border-radius: 8px;
            margin: 1rem 0;
        }
        code {
            background: #e5e7eb;
            padding: 2px 6px;
            border-radius: 4px;
            font-family: monospace;
        }
        .icon { font-size: 1.2em; margin-right: 0.5em; }
        ul { padding-left: 1.5rem; }
        li { margin: 0.5rem 0; }
        @media screen and (max-width: 600px) {
            body { padding: 10px; }
            .back-button { position: static; transform: none; margin-bottom: 1rem; display: inline-block; }
            .header { text-align: left; }
        }
    </style>
</head>
<body>
    <div class="header">
        <a href="#" id="backBtn" class="back-button" style="display: none;">â† Return to App</a>
        <h1>ğŸš´â€â™‚ï¸ MeteoRide</h1>
        <p>Plan your routes with detailed weather information</p>
    </div>

    <div class="section">
        <h2>ğŸš€ Introduction</h2>
        <p>MeteoRide is a web application designed for cyclists that lets you load GPX routes and get detailed weather forecasts along the route.</p>
        <p>The app automatically computes route steps based on the selected cycling speed and fetches data from multiple weather providers to show temperature, wind, precipitation, humidity, cloudiness, luminosity and more.</p>
        <p>It includes automatic fallback options to ensure data even if a provider fails, and lets you compare forecasts from different sources.</p>
        <p>It's ideal for planning safe, weather-aware rides.</p>
    </div>

    <div class="section">
        <h2>ğŸš€ Getting Started</h2>
        
        <div class="step">
            <h3>1. Load a GPX Route</h3>
            <p>Click the <strong>ğŸ“</strong> button to select your GPX file. MeteoRide supports standard tracks, routes and waypoints.</p>
            <div class="tip">
                <strong>ğŸ’¡ Tip:</strong> You can also use direct URLs with parameters like <code>?gpx_url=</code> to load routes automatically. For details about sharing routes from iOS or Android check the project page on GitHub.
            </div>
        </div>

        <div class="step">
            <h3>2. Configure Date and Time</h3>
            <p>Select when you plan to do the route. The system snaps to 15-minute intervals automatically.</p>
        </div>

        <div class="step">
            <h3>3. Adjust Speed</h3>
            <p>Enter your estimated average speed or use the presets: 5, 10, 12, 15, 20 km/h.</p>
        </div>

        <div class="step">
            <h3>4. Choose Interval</h3>
            <p>Select how frequently you want weather information (15 or 30 minutes).</p>
        </div>
        <div class="step">
            <h3>5. Choose Weather Provider</h3>
            <p>Select the weather provider you want to use to obtain the data.</p>
            <ul>
                <li><strong>Open-Meteo:</strong> Free, no API key required, up to 14 days forecast</li>
                <li><strong>MeteoBlue:</strong> Requires API key, up to 7 days, very accurate</li>
                <li><strong>OpenWeather:</strong> Requires API key, up to 5 days, detailed data</li>
                <li><strong>AromeHD:</strong> High-resolution model from MeteoFrance, available via Open-Meteo. Only available for parts of Europe (~39-52Â°N, 10.5Â°W-16.5Â°E) and within 48 hours; otherwise the app falls back to the best provider available through Open-Meteo. Especially useful for wind and short-term precipitation.</li>
                <li><strong>OpenWeather - AromeHD:</strong> Use OpenWeather for the first two hours, then Open-Meteo up to 36 hours. Routes outside this period are calculated with Open-Meteo. Only available if you provide an OpenWeather API key.</li>
                <li><strong>Compare (Comp.):</strong> Enable comparison mode to evaluate differences between providers.</li>
            </ul>
            <div class="tip">
                <strong>ğŸ’¡ Automatic Fallback:</strong> If your primary provider fails or has no data, MeteoRide automatically switches to Open-Meteo. MeteoRide will notify you with a brief message about the situation (if notifications are enabled in Settings).
            </div>
        </div>

    </div>

    <div class="section">
        <h2>ğŸ Install as App</h2>
        <p>MeteoRide can be installed as a Progressive Web App (PWA) on your device for an app-like experience.</p>

        <h3>Android</h3>
        <ol>
            <li>Open MeteoRide in Chrome.</li>
            <li>Tap the menu (three dots) in the top right.</li>
            <li>Select "Add to Home screen".</li>
            <li>Confirm by tapping "Add".</li>
        </ol>

        <h3>iOS (iPhone/iPad)</h3>
        <ol>
            <li>Open MeteoRide in Safari.</li>
            <li>Tap the Share button (square with arrow).</li>
            <li>Select "Add to Home Screen".</li>
            <li>Tap "Add" in the top right.</li>
        </ol>

        <h3>Chrome on Desktop</h3>
        <ol>
            <li>Open MeteoRide in Chrome.</li>
            <li>Click the install icon in the address bar or in the menu.</li>
            <li>Click "Install".</li>
        </ol>

        <h3>Edge on Desktop</h3>
        <ol>
            <li>Open MeteoRide in Edge.</li>
            <li>Click the install icon in the address bar.</li>
            <li>Click "Install".</li>
        </ol>

        <h3>Safari on Mac</h3>
        <ol>
            <li>Open MeteoRide in Safari.</li>
            <li>Go to File > Add to Dock.</li>
            <li>Or, click the Share button and select "Add to Dock".</li>
        </ol>
    </div>

    <div class="section">
        <h2>ğŸ› ï¸ Settings</h2>

        <h3>ğŸ”‘ API Keys</h3>
        <p>For MeteoBlue and OpenWeather you need to register and obtain a free API key:</p>
        <ul>
            <li><strong>MeteoBlue:</strong> <a href="https://meteoblue.com/weather-api" target="_blank">meteoblue.com/weather-api</a></li>
            <li><strong>OpenWeather (One Call API):</strong> <a href="https://openweathermap.org/api" target="_blank">openweathermap.org/api</a></li>
        </ul>
        <p>Use the <strong>ğŸ” Check</strong> button to verify your API key works correctly.</p>

        <h3>ğŸ”‘ API Key Tests and Notices</h3>
        <p>
            In the settings panel there are <code>Check</code> buttons for MeteoBlue and OpenWeather. When pressed the app makes a simple request and the status is shown next to the field (valid / invalid / quota / HTTP).
        </p>
        <p>
            There is also a checkbox <strong>Show non-critical notices</strong> that controls notification verbosity: if enabled you will see informational banners when fallbacks occur due to horizon limits, quota or API errors; if disabled only critical errors are shown.
        </p>
        <p class="small">
            When a provider exceeds its horizon or fails repeatedly, the app falls back to Openâ€‘Meteo only for the affected steps. This is indicated with a brief notice in the header.
        </p>
        <h3>ğŸ“ Units</h3>
        <ul>
            <li><strong>Wind:</strong> km/h, m/s, mph</li>
            <li><strong>Temperature:</strong> Â°C, Â°F</li>
            <li><strong>Distance:</strong> km, mi</li>
            <li><strong>Precipitation:</strong> mm, in</li>
        </ul>

        <h3>ğŸŒ Languages</h3>
        <p>The application supports Spanish and English. Select your preferred language in the settings to change the interface and messages.</p>
    </div>

    <div class="section">
        <h2>ğŸ“Š Interpreting the Data</h2>

        <h3>ğŸŒ¤ï¸ Weather Table</h3>
        <p>The table shows information hour by hour:</p>
        <ul>
            <li><strong>First row:</strong> Time and accumulated distance</li>
            <li><strong>Second row:</strong> Weather icons</li>
            <li><strong>Temperature:</strong> In degrees Celsius or Fahrenheit</li>
            <li><strong>Wind:</strong> Speed + direction arrow (gusts in parentheses)</li>
            <li><strong>Rain:</strong> Amount in mm/h (probability in parentheses)</li>
            <li><strong>Humidity:</strong> Relative humidity percentage</li>
            <li><strong>Cloudiness:</strong> Cloud cover percentage</li>
            <li><strong>Luminosity:</strong> Bar indicating available light (0-100%)</li>
            <li><strong>UV:</strong> Ultraviolet index</li>
        </ul>

        <h3>ğŸ—ºï¸ Interactive Map</h3>
        <ul>
            <li><strong>Blue arrows:</strong> Light wind (&lt;12 km/h)</li>
            <li><strong>Red arrows:</strong> Strong wind (30-50 km/h)</li>
            <li><strong>Purple arrows:</strong> Very strong wind (&gt;50 km/h)</li>
            <li><strong>Droplets ğŸ’§:</strong> Expected precipitation</li>
            <li><strong>Green/Red markers:</strong> Route start and end</li>
        </ul>

        <div class="tip">
            <strong>ğŸ’¡ Interactivity:</strong> Click any table column or a wind arrow on the map to see details for that point.
        </div>
    </div>

    <div class="section">
        <h2>ğŸ“± Advanced Features</h2>

        <h3>ğŸ”„ Horizontal Scrolling</h3>
        <p>
            The weather table is interactive and touch-friendly:
        </p>
        <ul>
            <li>Drag the table horizontally or use the mouse wheel to scroll columns (gestures and "dragâ€‘toâ€‘scroll").</li>
            <li>Click any column (or any cell to select that column) and the row and map will be highlighted.</li>
            <li>The map recenters on the selected point if you click a wind arrow or the column.</li>
            <li>If the penultimate column is less than 5 minutes away from the last one, the app hides it to avoid visual duplicates.</li>
        </ul>
        <p class="small">Tip: use the small â‡† icon that appears to indicate the table has more columns available when scrolling.</p>

        <h3>ğŸŒ… Solar Information</h3>
        <p>The app automatically shows:</p>
        <ul>
            <li>Sunrise and sunset times</li>
            <li>Civil twilight (marked with "c")</li>
            <li>Calculated luminosity according to time and conditions</li>
        </ul>

        <h3>ğŸ¯ Smart Fallbacks</h3>
        <p>MeteoRide handles automatically:</p>
        <ul>
            <li>Switching to Open-Meteo if your provider exceeds its time horizon</li>
            <li>Retries when there are temporary errors</li>
            <li>Clear notifications about data limitations</li>
        </ul>

        <h3>ğŸ”— URLs with Parameters</h3>
        <p>You can use direct links with parameters:</p>
        <ul>
            <li><code>?gpx_url=https://example.com/route.gpx</code></li>
            <li><code>?gpx_data=&lt;base64_data&gt;</code></li>
            <li><code>?datetime=2024-03-15T10:00</code></li>
            <li><code>?speed=25</code></li>
        </ul>
        <h3>ğŸ’¾ Local cache and performance</h3>
        <p>
            Provider responses are stored in <code>localStorage</code> for ~30 minutes per step/hour.
            This speeds up frequent reloads and reduces requests to rate-limited APIs. You can clear the cache from your browser devtools.
        </p>
    </div>

    <div class="section">
        <h2>âš ï¸ Limitations and Tips</h2>

        <div class="warning">
            <h3>ğŸš¨ Important Limits</h3>
            <ul>
                <li><strong>Time horizon:</strong> Open-Meteo (14 days), MeteoBlue (7 days), OpenWeather (2 days)</li>
                <li><strong>Accuracy:</strong> Forecasts are less reliable from day 3-4 onwards</li>
                <li><strong>Free APIs:</strong> MeteoBlue and OpenWeather free tiers have usage limits (Open-Meteo does not require an API key)</li>
            </ul>
        </div>

        <div class="tip">
            <h3>âœ… Best Practices</h3>
            <ul>
                <li>Use routes of maximum 100-200 km for better performance</li>
                <li>Plan 1-2 days in advance for greater accuracy</li>
                <li>Combine information from multiple sources for important decisions</li>
                <li>Always have a plan B for adverse conditions</li>
                <li>Carry rain gear even if the probability is low</li>
            </ul>
        </div>
    </div>

    <div class="section">
        <h2>ğŸ› Troubleshooting</h2>

        <h3>âŒ Common Issues</h3>
        <ul>
            <li><strong>GPX won't load:</strong> Verify that the file contains valid tracks</li>
            <li><strong>No weather data:</strong> Check your API key or use Open-Meteo</li>
            <li><strong>Date out of range:</strong> Reduce the time horizon</li>
            <li><strong>Empty table:</strong> Ensure the route has sufficient length</li>
        </ul>

    </div>

    <div class="section">
        <h2>ğŸ”’ Privacy and Data</h2>

        <div class="privacy">
            <h3>ğŸ›¡ï¸ Protecting your Privacy</h3>
            <p><strong>MeteoRide runs completely on your device.</strong> All settings, preferences and data are stored only in your browser localStorage. Only when using shortcuts to share a GPX will the file be uploaded to Cloudflare. This is necessary for iOS Shortcuts that only accept POST (if you open the file directly from MeteoRide it will not be uploaded since it is processed locally). In any case, the GPX file is deleted automatically after a maximum of two minutes.</p>

            <ul>
                <li><strong>No account:</strong> You don't need to create an account or provide personal data</li>
                <li><strong>Full control:</strong> You can delete all data from your browser settings</li>
                <li><strong>Open source:</strong> You can inspect the full source code on GitHub</li>
            </ul>
        </div>

        <h3>ğŸŒ Data Shared with Weather Providers</h3>
        <p>To obtain forecasts, MeteoRide only shares:</p>
        <ul>
            <li><strong>Geographic coordinates</strong> of the points in your route</li>
            <li><strong>Dates and times</strong> for which you need the forecast</li>
            <li><strong>Your API Key</strong> (if you use MeteoBlue or OpenWeather)</li>
        </ul>

        <div class="tip">
            <strong>ğŸ’¡ Note:</strong> Weather providers (Open-Meteo, MeteoBlue, OpenWeather) have their own privacy policies. MeteoRide only acts as a client requesting the forecast data you need.
        </div>

        <h3>ğŸ—‚ï¸ What is stored locally</h3>
        <ul>
            <li>Units and language settings</li>
            <li>API Keys (stored in your browser)</li>
            <li>Speed and interval preferences</li>
            <li>Temporary weather data cache (30 minutes)</li>
        </ul>
    </div>

    <div class="section">
        <h2>ğŸ“„ License and Credits</h2>

        <h3>ğŸ‘¨â€ğŸ’» Developer</h3>
        <p><strong>MeteoRide</strong> has been developed by <a href="https://github.com/lockevod" target="_blank" rel="noopener noreferrer"><strong>Lockevod</strong></a>.</p>

        <h3>ğŸ“ License</h3>
        <p>This project is licensed under the <strong>MIT License</strong>, which means:</p>
        <ul>
            <li>âœ… You can use the application freely</li>
            <li>âœ… You can modify the source code</li>
            <li>âœ… You can distribute your own version</li>
            <li>âœ… For personal and commercial use</li>
        </ul>

        <div class="tip">
            <strong>ğŸ“‹ Source Code:</strong> The complete code is available on <a href="https://github.com/lockevod/MeteoRide" target="_blank" rel="noopener noreferrer">GitHub</a>. Contributions are welcome!
        </div>

        <h3>ğŸ™ Technologies and Services</h3>
        <ul>
            <li><strong>Maps:</strong> OpenStreetMap and contributors</li>
            <li><strong>Weather Data:</strong> Open-Meteo, MeteoBlue, OpenWeather</li>
            <li><strong>Weather Icons:</strong> Weather Icons by Erik Flowers</li>
            <li><strong>Libraries:</strong> Leaflet.js, SunCalc, GPX parser</li>
            <li><strong>Hosting:</strong> GitHub Pages (optional)</li>
        </ul>

        <h3>âš–ï¸ Disclaimer</h3>
        <p>MeteoRide is a planning tool. Weather forecasts are estimates and may not be fully accurate. Always use your judgement and verify conditions before heading out. The developer is not responsible for decisions based on this information.</p>
    </div>

    <div class="section">
        <h2>ğŸ“ Support and Contributions</h2>
        <h3>ğŸ› Report Issues</h3>
        <ul>
            <li>Visit the <a href="https://github.com/lockevod/MeteoRide/issues" target="_blank" rel="noopener noreferrer">GitHub repository</a></li>
            <li>Enable debug mode (ğŸ) to get technical details</li>
            <li>Include device and browser details</li>
        </ul>

        <h3>ğŸ¤ Contribute to the Project</h3>
        <ul>
            <li>Fork the repository on GitHub</li>
            <li>Report bugs or suggest improvements</li>
            <li>Translate to new languages</li>
            <li>Improve the documentation</li>
        </ul>

        <div class="tip">
            <strong>ğŸ’¡ Final tip:</strong> Weather can change quickly! Use MeteoRide as a guide, but stay flexible and safe on your rides.
        </div>

        <h3>ğŸ’° Support the Project</h3>
        <p>If you find MeteoRide useful, consider supporting the project with a donation:</p>
        <p><a href="https://www.buymeacoffee.com/enderthor" target="_blank"><img src="https://cdn.buymeacoffee.com/buttons/v2/default-yellow.png" alt="Buy Me A Coffee" style="height: 60px !important;width: 217px !important;" ></a></p>
    </div>

    <script>
        // Auto-detect language and show return button if needed
        (function(){
            const urlParams = new URLSearchParams(window.location.search);
            const shouldShowReturn = urlParams.get('return') === 'true';
            if (shouldShowReturn) {
                const backBtn = document.getElementById('backBtn');
                if (backBtn) {
                    backBtn.style.display = 'inline-block';
                    backBtn.addEventListener('click', (e) => {
                        e.preventDefault();
                        if (window.history.length > 1) {
                            window.history.back();
                        } else {
                            window.location.href = 'index.html';
                        }
                    });
                }
            }
            const lang = navigator.language || navigator.userLanguage;
            if (lang && lang.startsWith('es')) {
                document.title = 'Ayuda - MeteoRide';
            }
        })();
    </script>
</body>
</html>
